规则说明：
╔═══════════════╦═══════════════════════════════════════════════════════════════════════════════════════════════════════╗
║    rule id    ║                                                  V501                                                 ║
╠═══════════════╬═══════════════════════════════════════════════════════════════════════════════════════════════════════╣
║   rule name   ║                                               IdenticalSubExprs                                       ║
╠═══════════════╬════════════════════════════════════════════════════════════════════════════════════════╦══════════════╣
║ rule catergory║                                               CopyError                                               ║
╠═══════════════╬════════════════════════════════════════════════════════════════════════════════════════╦══════════════╣
║   rule check  ║                                     表达式运算时，两个子表达式相同                                    ║
╠═══════════════╬═══════════════════════════════════════════════════════════════════════════════════════════════════════╣
║    message    ║ There are identical sub-expressions 'expr1' to the left and to the right of the 'operator1' operator. ║
╠═══════════════╬═════════════════════════════════════════════════════════════════════════════════════════════════╦═════╣
║     expr1     ║                                              一般子表达式                                             ║
╠═══════════════╬════════════════════════════════════════════════════════════════════════════════════════════════╦══════╣
║   operator1   ║                            涉及的运算符：&&,||,>, >=,<,<=,!=,+,-,*,/,|,&,^                            ║
╚═══════════════╩═══════════════════════════════════════════════════════════════════════════════════════════════════════╝

代码示例总结：
+--------------------------------------------------------------------------------------+
|                                   COPY ERROR!!!实例                                  |
+--------------------------------------------------------------------------------------+
| 序号  |                 示例                 |                  说明                   |
+------+--------------------------------------+----------------------------------------+
|   1  |            expr1 || expr1            |              相同子表达式                |
+------+--------------------------------------+----------------------------------------+
|   2  |      expr1||expr2||expr3||expr1      |        同1，表达式不相邻但在同一级          |
+------+--------------------------------------+----------------------------------------+
|   3  |           expr1 || (expr1)           |     同1，按优先级去除括号后expr1在同一级     |
+------+--------------------------------------+----------------------------------------+
|   4  | (expr1 && expr2) && (expr3 && expr2) |    同1，括号可有可无，去除expr2在同一级      |
+------+--------------------------------------+----------------------------------------+
|   5  |           MIN(expr1,expr1)           |            涉及宏，展开后同1              |
+------+--------------------------------------+----------------------------------------+
|   6  |    expr1==MACRO1 || expr1==MACRO1    |                 涉及宏                  |
+------+--------------------------------------+----------------------------------------+
|   7  |      expr1==NULL || expr1=='\0'      |     同值不同表示，NULL、'\0'和0相同        |
+------+--------------------------------------+----------------------------------------+
|   8  | NULL == pArchive || NULL == pArchive |         信息提示为: 0==pArchive          |
+------+--------------------------------------+----------------------------------------+

测试用例
规则说明：
+---------------+---------------------------------------------------------------------------+
|    rule id    |                                    V502                                   |
+---------------+---------------------------------------------------------------------------+
|   rule name   |                    LowerPriorityOfConditionalExpression                   |
+---------------+---------------------------------------------------------------------------+
| rule category |                             OperatorPriority                              |
+---------------+---------------------------------------------------------------------------+
|   rule check  |               '?:' 运算符优先级低于'foo'导致结果可能存在问题              |
+---------------+---------------------------------------------------------------------------+
|    message    | Perhaps the '?:' operator works in a different way than it was expected.  |
|               |       The '?:' operator has a lower priority than the 'foo' operator      |
+---------------+---------------------------------------------------------------------------+
|     'foo'     |                       运算符如|,*,+,-,/,<<,==,&&,<=                       |
+---------------+---------------------------------------------------------------------------+

代码示例总结：
+----------------------------------------------------------------------------+
|                                  V502示例                                  |
+----------------------------------------------------------------------------+
| 序号 |           示例           |                   说明                   |
+------+--------------------------+------------------------------------------+
|   1  |  expr1|expr2?expr3:expr4 | '|'优先级高于'?:'导致(expr1|expr2)先运算 |
+------+--------------------------+------------------------------------------+
|   2  |  expr1*expr2?expr3:expr4 |               '[+-*/]'>'?:'              |
+------+--------------------------+------------------------------------------+
|   3  |   ss<<expr1?expr2:expr3  |               '<<'优于'?:'               |
+------+--------------------------+------------------------------------------+
|   4  | expr1==expr2?expr3:expr4 |                 '=='>'?:'                |
+------+--------------------------+------------------------------------------+
|   5  | expr1&&expr2>expr3:expr4 |                 '&&'>'?:'                |
+------+--------------------------+------------------------------------------+
|   6  | expr1<=expr2?expr3:expr4 |                 '<='>'?:'                |
+------+--------------------------+------------------------------------------+

测试用例
规则说明：
+---------------+-----------------------------------------------+
|    rule id    |                      V503                     |
+---------------+-----------------------------------------------+
|   rule name   |             NonsensicalPointerComparision     |
+---------------+-----------------------------------------------+
| rule category |                    NonSense                   |
+---------------+-----------------------------------------------+
|   rule check  |                无意义的指针比较               |
+---------------+-----------------------------------------------+
|    message    | This is a nonsensical comparison: pointer < 0 |
+---------------+-----------------------------------------------+
|  'comparison' |                比较符:<,>,<=,>=               |
+---------------+-----------------------------------------------+

代码示例总结：
+-------------------------------------------------------------------------+
|                                 V503示例                                |
+-------------------------------------------------------------------------+
| 序号 |             示例             |                说明               |
+------+------------------------------+-----------------------------------+
|   1  |      int* point; point<0     | 指针比较无意义, 包含所有类型*指针 |
+------+------------------------------+-----------------------------------+
|   2  | typedef int * point; point<0 |            typedef指针            |
+------+------------------------------+-----------------------------------+
|   3  |          point[0]<0;         |            指针数组元素           |
+------+------------------------------+-----------------------------------+
|   4  |          a.point<0;          |              成员指针             |
+------+------------------------------+-----------------------------------+
|   5  |         a->fun1()<0;         |           函数返回值指针          |
+------+------------------------------+-----------------------------------+
测试用例
规则说明：
+---------------+---------------------------------------------------------------------------------+
|    rule id    |                                       V504                                      |
+---------------+---------------------------------------------------------------------------------+
|   rule name   |                           MissingSemicolonAfterReturn                           |
+---------------+---------------------------------------------------------------------------------+
| rule category |                                 MissingSomething                                |
+---------------+---------------------------------------------------------------------------------+
|   rule check  |                            Return语句后面肯能缺少';'                            |
+---------------+---------------------------------------------------------------------------------+
|    message    | It is highly probable that the semicolon ';' is missing after 'return' keyword. |
+---------------+---------------------------------------------------------------------------------+
|      tips     |                          当return 后出现大量非代码行时                          |
+---------------+---------------------------------------------------------------------------------+

代码示例总结：
+-----------------------------------------------------------------------------+
|                                   V504示例                                  |
+-----------------------------------------------------------------------------+
| 序号 |                       示例                       |        说明       |
+------+--------------------------------------------------+-------------------+
|      | if (!spfont) return // <=                        |                   |
|      | //TODO: figure out why do we need to append("")  |                   |
|      | // before clearing items properly...,            |                   |
|      |                                                  |                   |
|   1  | //Gtk is refusing to clear the combobox          |                   |
|      |  //when I comment out this line                  | return后面缺失';' |
|      |  this->append("");                               |                   |
|      |  this->remove_all();                             |                   |
+------+--------------------------------------------------+-------------------+
测试用例
规则说明：
+---------------+---------------------------------------------------------------------------------+
|    rule id    |                                       V505                                      |
+---------------+---------------------------------------------------------------------------------+
|   rule name   |                                   AllocaInLoop                                  |
+---------------+---------------------------------------------------------------------------------+
| rule category |                                     Overflow                                    |
+---------------+---------------------------------------------------------------------------------+
|   rule check  |                        循环语句中使用"alloca"导致内存溢出                       |
+---------------+---------------------------------------------------------------------------------+
|    message    | The 'alloca' function is used inside the loop. This can quickly overflow stack. |
+---------------+---------------------------------------------------------------------------------+

代码示例总结：
+-----------------------------------------------------------------------------------------------------+
|                                               V505示例                                              |
+-----------------------------------------------------------------------------------------------------+
| 序号 |                                   示例                                  |        说明        |
+------+-------------------------------------------------------------------------+--------------------+
|      | #define CS_ALLOC_STACK_ARRAY(type, var, size) \                         |                    |
|      | type *var = (type *)alloca ((size) * sizeof (type))                     |                    |
|      |                                                                         |                    |
|      | void Scene::PropagateLight (....)                                       |                    |
|      | {                                                                       |                    |
|      |    ...                                                                  | 宏定义申请空间内存 |
|      |   PortalRefArray::Iterator it =                                         |                    |
|   1  |        sourceSector->allPortals.GetIterator ();                         |                    |
|      |    while (it.HasNext ())                                                |                    |
|      |    {                                                                    |                    |
|      |       ...                                                               |                    |
|      |      CS_ALLOC_STACK_ARRAY(csVector3,                                    |                    |
|      |       tmpVertices, portal->worldVertices.GetSize ());                   |                    |
|      |       ...                                                               |                    |
|      |    }                                                                    |                    |
|      | }                                                                       |                    |
+------+-------------------------------------------------------------------------+--------------------+
|      | for(;;)                                                                 |                    |
|      | {                                                                       |      for 循环      |
|   2  |      T2A(str.GetBuffer(1)), str.GetLength());                           |                    |
|      | }                                                                       |                    |
+------+-------------------------------------------------------------------------+--------------------+
|      | do{                                                                     |                    |
|      |     CTriVertex *snVertex =,(CTriVertex *) alloca(2*sizeof(CTriVertex)); |    do while 循环   |
|   3  | }                                                                       |                    |
|      | while(...);                                                             |                    |
+------+-------------------------------------------------------------------------+--------------------+
测试用例
规则说明：
+---------------+------------------------------------------------------------------------------+
|    rule id    |                                     V506                                     |
+---------------+------------------------------------------------------------------------------+
|   rule name   |                          InvalidPointToLocalVariable                         |
+---------------+------------------------------------------------------------------------------+
| rule category |                                 InvalidPoint                                 |
+---------------+------------------------------------------------------------------------------+
|   rule check  |                         指针内容指向局部变量导致失效                         |
+---------------+------------------------------------------------------------------------------+
|    message    | Pointer to local variable 'X' is stored outside the scope of this variable.  |
|               |                      Such a pointer will become invalid.                     |
+---------------+------------------------------------------------------------------------------+
|      'X'      |                  任何指针变量，包含基本类型，类，自定义结构                  |
+---------------+------------------------------------------------------------------------------+

代码示例总结：
+--------------------------------------------------------------+
|                           V506示例                           |
+--------------------------------------------------------------+
| 序号 |              示例              |         说明         |
+------+--------------------------------+----------------------+
|      | gloabl_var;{                   |                      |
|   1  |     local_var;                 | 指针指向局部变量指针 |
|      |     global_var= &local_var;    |                      |
|      | }                              |                      |
+------+--------------------------------+----------------------+
|      | if(...){                       |                      |
|      | FT_Bitmap NewBitmap;           |        if语句        |
|   2  | ....                           |                      |
|      | Bitmap = &NewBitmap;           |                      |
|      | }                              |                      |
+------+--------------------------------+----------------------+
测试用例
规则说明：
+---------------+------------------------------------------------------------------------+
|    rule id    |                                  V507                                  |
+---------------+------------------------------------------------------------------------+
|   rule name   |                        InvalidPointToLocalArray                        |
+---------------+------------------------------------------------------------------------+
| rule category |                              InvalidPoint                              |
+---------------+------------------------------------------------------------------------+
|   rule check  |                      指针内容指向局部数组导致失效                      |
+---------------+------------------------------------------------------------------------+
|    message    | Pointer to local array 'X' is stored outside the scope of this array.  |
|               |                                                                        |
|               |                   Such a pointer will become invalid.                  |
+---------------+------------------------------------------------------------------------+

代码示例总结：
+----------------------------------------------------------------------------------------------------+
|                                              V507示例                                              |
+----------------------------------------------------------------------------------------------------+
| 序号 |                        示例                       | 说明                                    |
+------+---------------------------------------------------+-----------------------------------------+
|      | class CVariable {                                 |                                         |
|      |  public:char name[64];// Name as it is referenced |                                         |
|      | ...                                               |                                         |
|      | };                                                |                                         |
|      | void CRendererContext::RiGeometryV(char *type,    |                                         |
|      | int n,char *tokens[],void *params[])              |                                         |
|      | {                                                 |                                         |
|      | ...                                               | Pointer to local array 'var' is stored  |
|   1  |   else {                                          | outside the scope of this array.        |
|      | CVariable var;                                    | Such a pointer will become invalid.     |
|      | if (parseVariable(&var,NULL,tokens[i])) {         |                                         |
|      | tokens[i] = var.name;                             |                                         |
|      | }                                                 |                                         |
|      | ...                                               |                                         |
|      | }                                                 |                                         |
+------+---------------------------------------------------+-----------------------------------------+
测试用例
规则说明：
+---------------+-------------------------------------------------------+
|    rule id    |                          V509                         |
+---------------+-------------------------------------------------------+
|   rule name   |      IllegalThrowWithoutInTryCatchInDestructor        |
+---------------+-------------------------------------------------------+
| rule category |                        Illegal                        |
+---------------+-------------------------------------------------------+
|   rule check  |         析构函数内异常抛出应放在try...catch中         |
+---------------+-------------------------------------------------------+
|               | The 'throw' operator inside the destructor should be  |
|    message    |          placed within the try..catch block.          |
|               |  Raising exception inside the destructor is illegal.  |
+---------------+-------------------------------------------------------+
代码示例总结：
+-----------------------------------------------------------------------------+
|                                   V509示例                                  |
+-----------------------------------------------------------------------------+
| 序号 |               示例               | 说明                              |
+------+----------------------------------+-----------------------------------+
|      | A:~A{                            |                                   |
|      |     if(){                        | 'throw'应放在try catch中          |
|   1  |   throw ...;                     |                                   |
|      | }}                               |                                   |
+------+----------------------------------+-----------------------------------+
| 2    | A:~A{                            | 'new'应该放在try...catch中        |
|      | m_worker.Put(new WorkerTask());  |                                   |
|      | }                                |                                   |
+------+----------------------------------+-----------------------------------+
| 3    | virtual ~LazyFieldmarkDeleter(){ | dynamic_cast<T&>应放在try catch中 |
|      | dynamic_cast<Filedmark&>(        |                                   |
|      | *m_pFieldmark.get()).            |                                   |
|      | ReleaseDoc(m_pDoc);}             |                                   |
+------+----------------------------------+-----------------------------------+
测试用例
规则说明：
+---------------+-----------------------------------------------+
|    rule id    |                      V510                     |
+---------------+-----------------------------------------------+
|   rule name   |                ClassAsStringArgument          |
+---------------+-----------------------------------------------+
| rule category |                    Illegal                    |
+---------------+-----------------------------------------------+
|   rule check  |            格式化时不能用类作为参数           |
+---------------+-----------------------------------------------+
|               | The 'Foo' function is not expected to receive |
|    message    |   class-type variable as 'N' actual argument. |
+---------------+-----------------------------------------------+

代码示例总结：
+------------------------------------------------------------------------------------------------+
|                                            V510示例                                            |
+------------------------------------------------------------------------------------------------+
| 序号 |                              示例                              |          说明          |
+------+----------------------------------------------------------------+------------------------+
|      | wstring myDBFName;                                             | "%s"格式化应为字符串， |
|   1  | printf("Cannot open database %s",myDBFName);                   |        不应为类        |
+------+----------------------------------------------------------------+------------------------+
|   2  | std::string encoded_login;                                     |   encoded_login为类，  |
|      | sprintf(SendBuf, "AUTH PLAIN %s",encoded_login);               |        非字符串        |
+------+----------------------------------------------------------------+------------------------+
|   3  | std::string fileName;                                          |                        |
|      | assertion(header, "Cannot open file %s\n", fileName);          |           同2          |
+------+----------------------------------------------------------------+------------------------+
|   4  | wstring tofname;wsprintf(errMsg, L"Failed to update Telegram : |           同2          |
|      | (\n%s is not accessible.", tofname);                           |                        |
+------+----------------------------------------------------------------+------------------------+
测试用例
规则说明：
+---------------+-----------------------------------------------------+
|    rule id    |                         V511                        |
+---------------+-----------------------------------------------------+
|   rule name   |         InvalidSizeOfArgumentArrayPoint             |
+---------------+-----------------------------------------------------+
| rule category |                       Invalid                       |
+---------------+-----------------------------------------------------+
|   rule check  |            'sizeof'返回的是数组指针大小，           |
|               |                     而非数组大小                    |
+---------------+-----------------------------------------------------+
|               | The sizeof() operator returns size of the pointer,  |
|    message    |      and not of the array, in given expression.     |
+---------------+-----------------------------------------------------+

代码示例总结：
+---------------------------------------------------------------------------------------------+
|                                           V511示例                                          |
+---------------------------------------------------------------------------------------------+
| 序号 |                             示例                            |          说明          |
+------+-------------------------------------------------------------+------------------------+
|   1  | float src[3][3];                                            | sizeof求的是指针大小， |
|      | memcpy( mat, src, sizeof(src) );                            |       非数组大小       |
+------+-------------------------------------------------------------+------------------------+
|   2  | memset( result, 0, sizeof( result ) );                      |          同上          |
+------+-------------------------------------------------------------+------------------------+
|   3  | #define fstrcpy(d,s) safe_strcpy((d),(s),sizeof(fstring)-1) |                        |
|      | fstrcpy(user, domuser);                                     |          同上          |
+------+-------------------------------------------------------------+------------------------+
|   4  | #define _ARRAYSIZE(A),RTL_NUMBER_OF_V1(A);                  |          同上          |
|      | if(nNeighbors < _ARRAYSIZE( iNeighbors)){...}               |                        |
+------+-------------------------------------------------------------+------------------------+
测试用例
规则说明：
+---------------+-------------------------------------------+
|    rule id    |                    V512                   |
+---------------+-------------------------------------------+
|   rule name   |  MemFunCallLeadOverOrUnderFlowWithSizeof  |
+---------------+-------------------------------------------+
| rule category |                  Overflow                 |
+---------------+-------------------------------------------+
|   rule check  |              函数调用导致flow             |
+---------------+-------------------------------------------+
|    message    | A call of the 'Foo' function will lead to |
|               |       a buffer overflow or underflow.     |
+---------------+-------------------------------------------+
|     'Foo'     |           常见函数memset, memcpy          |
+---------------+-------------------------------------------+

代码示例总结：
+-----------------------------------------------------------------------------------------------------------+
|                                                  V512示例                                                 |
+-----------------------------------------------------------------------------------------------------------+
| 序号 |                            示例                            |                  说明                 |
+------+------------------------------------------------------------+---------------------------------------+
|   1  | uint1 buffer[64];                                          |                应该写为               |
|      | ...                                                        |  memset (buffer, 0, sizeof(buffer));  |
|      | // Zeroize sensitive information                           |                                       |
|      | memset (buffer, 0, sizeof(*buffer));                       |                                       |
+------+------------------------------------------------------------+---------------------------------------+
|      | dgInt32 faceOffsetHitogram[256];                           |                  同上                 |
|      | dgSubMesh* mainSegmenst[256];                              |                                       |
|   2  | ...                                                        |                                       |
|      | memset(faceOffsetHitogram, 0, sizeof(faceOffsetHitogram)); |                                       |
|      | memset(mainSegmenst, 0, sizeof(faceOffsetHitogram));       |                                       |
+------+------------------------------------------------------------+---------------------------------------+
|   3  | ::CopyMemory(tr.lpstrText, L"mailto:", 7);                 |          sizeof(wchar_t) * 7          |
+------+------------------------------------------------------------+---------------------------------------+
|   4  | int s_attr_table[256];                                     |           sizeof(int) * 256           |
|      | memset(s_attr_table, 0, 256);                              |                                       |
+------+------------------------------------------------------------+---------------------------------------+
|   5  | PluginInfo *PInfo=(PluginInfo *)vParam;                    | memset(PInfo, 0, sizeof(PluginInfo)); |
|      | memset(PInfo,0,sizeof(PInfo));                             |                                       |
+------+------------------------------------------------------------+---------------------------------------+

测试用例
规则说明：
+---------------+-----------------------------------------------+
|    rule id    |                      V513                     |
+---------------+-----------------------------------------------+
|   rule name   |              UseOldUnsafeFunction             |
+---------------+-----------------------------------------------+
| rule category |                  Replacement                  |
+---------------+-----------------------------------------------+
|   rule check  |               使用更安全函数调用              |
+---------------+-----------------------------------------------+
|    message    |   Use _beginthreadex/_endthreadex functions   |
|               | instead of CreateThread/ExitThread functions. |
+---------------+-----------------------------------------------+

代码示例总结：
+--------------------------------------------------+
|                     V513示例                     |
+--------------------------------------------------+
| 序号 |                示例                | 说明 |
+------+------------------------------------+------+
|   1  | HANDLE hThread = CreateThread (... |      |
+------+------------------------------------+------+

测试用例
规则说明：
+---------------+---------------------------------------------------+
|    rule id    |                        V514                       |
+---------------+---------------------------------------------------+
|   rule name   |       DividingSizeofAPointerByAnotherValue        |
+---------------+---------------------------------------------------+
| rule category |                      Dividing                     |
+---------------+---------------------------------------------------+
|   rule check  |                 sizeof相除存在问题                |
+---------------+---------------------------------------------------+
|    message    |    Dividing sizeof a pointer by another value.    |
|               | There is a probability of logical error presence. |
+---------------+---------------------------------------------------+

代码示例总结：
+------------------------------------------------------------------+
|                             V514示例                             |
+------------------------------------------------------------------+
| 序号 |                    示例                    |     说明     |
+------+--------------------------------------------+--------------+
|   1  | #define SIZEOF(X) (sizeof(X)/sizeof(X[0])) |    X为指针   |
+------+--------------------------------------------+--------------+
|   2  | sizeof(szText)/sizeof(WCHAR)               | szText为指针 |
+------+--------------------------------------------+--------------+
|   3  | sizeof(tvi.pszText)/sizeof(tvi.pszText[0]) |     同上     |
+------+--------------------------------------------+--------------+

测试用例
规则说明：
+---------------+----------------------------------------------------------------+
|    rule id    |                              V516                              |
+---------------+----------------------------------------------------------------+
|   rule name   |             NoNullFunctionPointerComparedWithNull              |
+---------------+----------------------------------------------------------------+
| rule category |                            NonSense                            |
+---------------+----------------------------------------------------------------+
|   rule check  |                  函数指针(一定非空)和null比较                  |
+---------------+----------------------------------------------------------------+
|    message    |             Consider inspecting an odd expression.             |
|               | Non-null function pointer is compared to null: 'sf_error != 0' |
+---------------+----------------------------------------------------------------+

代码示例总结：
+---------------------------------------------------------------+
|                            V516示例                           |
+---------------------------------------------------------------+
| 序号 |              示例              |          说明         |
+------+--------------------------------+-----------------------+
|   1  | if (! sndfile)                 |   sndfile为函数指针   |
+------+--------------------------------+-----------------------+
|   2  | if (MP285::GetMotionMode == 0) | GetMotionMode为函数名 |
+------+--------------------------------+-----------------------+

测试用例
规则说明：
+---------------+--------------------------------------------------------------------+
|    rule id    |                                V517                                |
+---------------+--------------------------------------------------------------------+
|   rule name   |                         RepeatedIfCondition                        |
+---------------+--------------------------------------------------------------------+
| rule category |                              Repeated                              |
+---------------+--------------------------------------------------------------------+
|   rule check  |                          重复的if条件语句                          |
+---------------+--------------------------------------------------------------------+
|    message    | The use of 'if (A) {...} else if (A) {...}' pattern was detected.  |
|               |          There is a probability of logical error presence.         |
+---------------+--------------------------------------------------------------------+

代码示例总结：
+---------------------------------------+
|                V517示例               |
+---------------------------------------+
| 序号 |     示例     |       说明      |
+------+--------------+-----------------+
|      | if(A){}      |                 |
|   1  | else if(B){} |                 |
|      | else if(c){} | 重复的条件语句A |
|      | else if(A){} |                 |
+------+--------------+-----------------+

测试用例
规则说明：
+---------------+-----------------------------------------------------------------------------------------+
|    rule id    |                                           V518                                          |
+---------------+-----------------------------------------------------------------------------------------+
|   rule name   |                           StrlenConstantValueInMalloc                                   |
+---------------+-----------------------------------------------------------------------------------------+
| rule category |                                    UnderlyingProblem                                    |
+---------------+-----------------------------------------------------------------------------------------+
|   rule check  |                               开辟空间时strlen使用潜在问题                              |
+---------------+-----------------------------------------------------------------------------------------+
|    message    | The 'malloc' function allocates strange amount of memory calculated by 'strlen(expr+1)' |
|               |                    . Perhaps the correct variant is strlen(expr) + 1                    |
+---------------+-----------------------------------------------------------------------------------------+

代码示例总结：
+--------------------------------------------------------------+
|                           V518示例                           |
+--------------------------------------------------------------+
| 序号 |             示例             |          说明          |
+------+------------------------------+------------------------+
|      | if((t=(char *)realloc(       | 应该写成strlen(name)+1 |
|   1  | next->name,strlen(name+1)))) |                        |
+------+------------------------------+------------------------+

测试用例
规则说明：
+---------------+----------------------------------------------------------+
|    rule id    |                           V519                           |
+---------------+----------------------------------------------------------+
|   rule name   |             AssignSameVariableTwiceSuccessively          |
+---------------+----------------------------------------------------------+
| rule category |                     UnderlyingProblem                    |
+---------------+----------------------------------------------------------+
|   rule check  |                  连续两次对同一变量赋值                  |
+---------------+----------------------------------------------------------+
|    message    | The 'x' variable is assigned values twice successively.  |
|               |                Perhaps this is a mistake.                |
+---------------+----------------------------------------------------------+

代码示例总结：
+--------------------------------------------------------------------------------+
|                                    V519示例                                    |
+--------------------------------------------------------------------------------+
| 序号 |                     示例                     |           说明           |
+------+----------------------------------------------+--------------------------+
|      | ...                                          |                          |
|   1  | prev = m_HLEndPosPtr->m_prev;                | 变量'prev'被连续两次赋值 |
|      | prev = m_HLEndPosPtr->m_next = NULL;         |                          |
|      | ...                                          |                          |
+------+----------------------------------------------+--------------------------+
|   2  | ...                                          |           同上           |
|      | m_clrSample = GetSysColor(COLOR_WINDOWTEXT); |                          |
|      | m_clrSample = RGB(60,0,0);                   |                          |
|      | ...                                          |                          |
+------+----------------------------------------------+--------------------------+

测试用例
规则说明：
+---------------+---------------------------------------------------+
|    rule id    |                        V520                       |
+---------------+---------------------------------------------------+
|   rule name   |                UseCommaInArrayIndex               |
+---------------+---------------------------------------------------+
| rule category |                 UnderlyingProblem                 |
+---------------+---------------------------------------------------+
|   rule check  |                  数组下标使用','                  |
+---------------+---------------------------------------------------+
|    message    | The comma operator ',' in array index expression. |
+---------------+---------------------------------------------------+

代码示例总结：
+----------------------------------------------------------------------------+
|                                  V520示例                                  |
+----------------------------------------------------------------------------+
| 序号 |                 示例                 |             说明             |
+------+--------------------------------------+------------------------------+
|      | t.printf("%10.5f, %10.5f, %10.5f,\n" |                              |
|   1  | "%10.5f, %10.5f, %10.5f,\n"          |                              |
|      | "%10.5f, %10.5f, %10.5f)",           |           应该写成           |
|      | m[0, 0], m[0, 1], m[0, 2],           | ...., m[0][0], m[0][1], .... |
|      | m[1, 0], m[1, 1], m[1, 2],           |                              |
|      | m[2, 0], m[2, 1], m[2, 2]);          |                              |
+------+--------------------------------------+------------------------------+

测试用例
规则说明：
+---------------+--------------------------------------------------------+
|    rule id    |                          V521                          |
+---------------+--------------------------------------------------------+
|   rule name   |                  UseUnSenseCommaInExpression           |
+---------------+--------------------------------------------------------+
| rule category |                    UnderlyingProblem                   |
+---------------+--------------------------------------------------------+
|   rule check  |                 表达式中无意义的使用','                |
+---------------+--------------------------------------------------------+
|    message    | Such expressions using the ',' operator are dangerous. |
|               |           Make sure the expression is correct.         |
+---------------+--------------------------------------------------------+

代码示例总结：
+-----------------------------------------------------------------------------------+
|                                      V521示例                                     |
+-----------------------------------------------------------------------------------+
| 序号 |                          示例                          |        说明       |
+------+--------------------------------------------------------+-------------------+
|      |                                                        |                   |
|      | ...                                                    |                   |
|      | bleeding = 0;                                          | bleedy无意义使用, |
|   1  | bleedx = 0,bleedy;                                     |   应为'bleedy=0'  |
|      | direction = 0;                                         |                   |
|      | ...                                                    |                   |
+------+--------------------------------------------------------+-------------------+
|      | ...                                                    |                   |
|   2  | q1_allocatedbspmem +=                                  |   无意义的sizeof  |
|      | Q1_MAX_MAP_EDGES , sizeof(q1_dedge_t);// <=            |                   |
|      | ...                                                    |                   |
+------+--------------------------------------------------------+-------------------+
| 3    | for (i = pIppTDParams->dtmf_fs, j = 0;                 |      应为"&&"     |
|      | i < dtmf_frame_size+pIppTDParams->dtmf_fs, j < nbytes; |                   |
|      | i++, j++)                                              |                   |
+------+--------------------------------------------------------+-------------------+
测试用例
规则说明：
+---------------+-----------------------------------------------------+
|    rule id    |                         V522                        |
+---------------+-----------------------------------------------------+
|   rule name   |               DereferencingNullPointer              |
+---------------+-----------------------------------------------------+
| rule category |                  UnderlyingProblem                  |
+---------------+-----------------------------------------------------+
|   rule check  |                 使用空指针指向的内容                |
+---------------+-----------------------------------------------------+
|    message    | Dereferencing of the null pointer might take place. |
+---------------+-----------------------------------------------------+

代码示例总结：
+------------------------------------------------------------------------------------+
|                                      V522示例                                      |
+------------------------------------------------------------------------------------+
| 序号 |                       示例                      |            说明           |
+------+-------------------------------------------------+---------------------------+
|      | if (!plugin_instance &&                         | plugin_instance为空时错误 |
|   1  | (plugin_instance->automation_client_.get()))    |                           |
+------+-------------------------------------------------+---------------------------+
|      | ...                                             |                           |
|   2  | if (DI == 0) {                                  |     DI==0时不能使用*DI    |
|      | errs() << "Unknown leaf kind: " << *DI << "\n"; |                           |
|      | }...                                            |                           |
+------+-------------------------------------------------+---------------------------+
测试用例
规则说明：
+---------------+-------------------------------------------------------------+
|    rule id    |                             V523                            |
+---------------+-------------------------------------------------------------+
|   rule name   |                   ThenAndElseBodyEquivalent                 |
+---------------+-------------------------------------------------------------+
| rule category |                           Repeated                          |
+---------------+-------------------------------------------------------------+
|   rule check  |                  'then'和'else'内部语句相同                 |
+---------------+-------------------------------------------------------------+
|    message    | The 'then' statement is equivalent to the 'else' statement. |
+---------------+-------------------------------------------------------------+

代码示例总结：
+---------------------------------------------------------------------+
|                               V523示例                              |
+---------------------------------------------------------------------+
| 序号 |                  示例                 |         说明         |
+------+---------------------------------------+----------------------+
|      | ...                                   |                      |
|   1  | if (!_isVertical)                     |                      |
|      | Flags |= DT_BOTTOM;                   |  if...else内语句相同 |
|      | else                                  |                      |
|      | Flags |= DT_BOTTOM;                   |                      |
|      | ...                                   |                      |
+------+---------------------------------------+----------------------+
|      | ...if (this->samples_count () == 1u)  |                      |
|      | {                                     |                      |
|      | this->throughput_last_= throughput;   |                      |
|      | }                                     |                      |
|      | else                                  |   if...else内部语句  |
|   2  | {                                     | 并不完全相同，如空格 |
|      | this->throughput_last_ =  throughput; |                      |
|      | }                                     |                      |
|      | ...                                   |                      |
+------+---------------------------------------+----------------------+
测试用例
规则说明：
+---------------+------------------------------------------------------+
|    rule id    |                         V524                         |
+---------------+------------------------------------------------------+
|   rule name   |                TwoFunctionBodyEquivalent             |
+---------------+------------------------------------------------------+
| rule category |                      Equivalent                      |
+---------------+------------------------------------------------------+
|   rule check  |                两个函数体内部完全相同                |
+---------------+------------------------------------------------------+
|    message    |     It is odd that the body of 'Foo_1' function      |
|               | is fully equivalent to the body of 'Foo_2' function. |
+---------------+------------------------------------------------------+

代码示例总结：
+------------------------------------------------------------------+
|                             V524示例                             |
+------------------------------------------------------------------+
| 序号 |                   示例                   |      说明      |
+------+------------------------------------------+----------------+
|      | int NpingStats::startRuntime(){          |                |
|   1  | this->run_timer.start();                 |                |
|      | return OP_SUCCESS;                       | 两个函数体内部 |
|      | }                                        |    完全相同    |
|      | int NpingStats::stopRuntime(){           |                |
|      | this->run_timer.start();                 |                |
|      | return OP_SUCCESS;                       |                |
|      | }                                        |                |
+------+------------------------------------------+----------------+
|      | CharIndexedVectorIterator& operator++()  |                |
|      | { // preincrement                        |                |
|      | ++m_itr;                                 |                |
|      | return (*this);                          |                |
|      | }                                        |                |
|   2  | CharIndexedVectorIterator& operator--()  |      同上      |
|      | {                                        |                |
|      | // predecrement                          |                |
|      | ++m_itr;                                 |                |
|      | return (*this);                          |                |
|      | }                                        |                |
+------+------------------------------------------+----------------+
测试用例
规则说明：
+---------------+-------------------------------------------------------+
|    rule id    |                          V525                         |
+---------------+-------------------------------------------------------+
|   rule name   |               SimilarCollectionOfBlockCode            |
+---------------+-------------------------------------------------------+
| rule category |                       CopyError                       |
+---------------+-------------------------------------------------------+
|   rule check  |                 一系列相同结构的代码块                |
+---------------+-------------------------------------------------------+
|    message    | The code containing the collection of similar blocks. |
|               |    Check items X, Y, Z, ... in lines N1, N2, N3, ...  |
+---------------+-------------------------------------------------------+

代码示例总结：
+-------------------------------------------------------------------------------------+
|                                       V525示例                                      |
+-------------------------------------------------------------------------------------+
| 序号 |                           示例                          | 说明               |
+------+---------------------------------------------------------+--------------------+
|      | ...                                                     |                    |
|      | case IDM_FILE_OPEN:                                     |                    |
|      | // Refer to the tutorial for an example of OnFileOpen   |                    |
|      | OnFileOpen();                                           |                    |
|      | return TRUE;                                            |                    |
|      | case IDM_FILE_SAVE:                                     |                    |
|      | // Refer to the tutorial for an example of OnFileSave   |                    |
|      | OnFileSave();                                           | case '2'和case '3' |
|   1  | return TRUE;                                            | 模式不一样         |
|      | case IDM_FILE_SAVEAS:                                   |                    |
|      | // Refer to the tutorial for an example of OnFileSaveAs |                    |
|      | OnFileSave();                                           |                    |
|      | return TRUE;                                            |                    |
|      | ...                                                     |                    |
+------+---------------------------------------------------------+--------------------+
|      | if(lset)                                                |                    |
|      | {                                                       |                    |
|      | fhead[11] = '\0';                                       | fhead[13]          |
|   2  | fhead[12] = '\0';                                       | 模式变化           |
|      | fhead[13] = '\0';                                       |                    |
|      | fhead[13] = '\0';                                       |                    |
|      | }                                                       |                    |
+------+---------------------------------------------------------+--------------------+
|      | tmp.i1 = *in.in1;                                       |                    |
|   3  | tmp.i2 = *in.in2;                                       |                    |
|      | tmp.i3 = *in.in2;                                       |                    |
+------+---------------------------------------------------------+--------------------+
测试用例
规则说明：
+---------------+-------------------------------------------------+
|    rule id    |                       V526                      |
+---------------+-------------------------------------------------+
|   rule name   |                CmpFuncUseInCondition            |
+---------------+-------------------------------------------------+
| rule category |                 FunctionUseError                |
+---------------+-------------------------------------------------+
|   rule check  |               strcmp, memcmp比较时              |
|               |                   应使用比较符                  |
+---------------+-------------------------------------------------+
|    message    |         The 'strcmp' function returns 0         |
|               |        if corresponding strings are equal.      |
|               |  Consider examining the condition for mistakes. |
+---------------+-------------------------------------------------+

代码示例总结：
+----------------------------------------------------------------------------------+
|                                     V526示例                                     |
+----------------------------------------------------------------------------------+
| 序号 |                          示例                          | 说明             |
+------+--------------------------------------------------------+------------------+
|      | ...                                                    |                  |
|      | } else if (erlangBIFs.InList(cur)                      | 应该写成         |
|   1  | && strcmp(cur,"erlang:")){                             | strcmp() == 0 或 |
|      | style = SCE_ERLANG_BIFS;                               | strcmp() != 0    |
|      | }...                                                   |                  |
+------+--------------------------------------------------------+------------------+
|      | if (.... ||                                            |                  |
|   2  | memcmp(spki->data, P256_SPKI_PREFIX,                   | 应该写           |
|      | sizeof(P256_SPKI_PREFIX) != 0))                        | memcmp()!=0      |
+------+--------------------------------------------------------+------------------+
|      | if (memcmp(&(beentry->st_clientaddr),&zero_clientaddr, | 同上             |
|   3  | sizeof(zero_clientaddr) == 0))                         |                  |
+------+--------------------------------------------------------+------------------+
测试用例
规则说明：
+---------------+----------------------------------------------------------+
|    rule id    |                           V527                           |
+---------------+----------------------------------------------------------+
|   rule name   |               AssignZeroValueToPointer                   |
+---------------+----------------------------------------------------------+
| rule category |                       PointerError                       |
+---------------+----------------------------------------------------------+
|   rule check  |                      指针赋值错误，                      |
|               |                  应该为指针指向内存更新                  |
+---------------+----------------------------------------------------------+
|    message    | It is odd that the 'zero' value is assigned to pointer.  |
|               |               Probably meant: *ptr = zero.               |
+---------------+----------------------------------------------------------+

代码示例总结：
+--------------------------------------------------------------------------+
|                                 V527示例                                 |
+--------------------------------------------------------------------------+
| 序号 |         示例        | 说明                                        |
+------+---------------------+---------------------------------------------+
|      | if (key_len > 79)   | It is odd that the '\0' value is assigned   |
|      | {                   | to 'char' type pointer.                     |
|   1  | new_key[79] = '\0'; | Probably meant: *new_key [79] = '\0'        |
|      | key_len = 79;       |                                             |
|      | }                   |                                             |
+------+---------------------+---------------------------------------------+
|      |                     | It is odd that the '\0' value is assigned   |
|   2  | tag->arg = '\0';    |  to 'char' type pointer.                    |
|      |                     | Probably meant: *tag->arg = '\0'.           |
+------+---------------------+---------------------------------------------+
|      |                     | It is odd that the L'\0' value is assigned  |
|   3  | lpBackSlash = '\0'; | to 'wchar_t' type pointer.                  |
|      |                     |  Probably meant: *lpBackSlash = L'\0'       |
+------+---------------------+---------------------------------------------+
测试用例
规则说明：
+---------------+-----------------------------------------------------------+
|    rule id    |                            V528                           |
+---------------+-----------------------------------------------------------+
|   rule name   |             ComparePointerWithZeroValue                   |
+---------------+-----------------------------------------------------------+
| rule category |                        Comparision                        |
+---------------+-----------------------------------------------------------+
|   rule check  |                   指针和'zero'比较出错,                   |
|               |                   应该为指向内容和0比较                   |
+---------------+-----------------------------------------------------------+
|    message    | It is odd that pointer is compared with the 'zero' value. |
|               |                Probably meant: *ptr != zero.              |
+---------------+-----------------------------------------------------------+

代码示例总结：
+------------------------------------------------------------------------------------------------------------------+
|                                                     V528示例                                                     |
+------------------------------------------------------------------------------------------------------------------+
| 序号 |                          示例                         | 说明                                              |
+------+-------------------------------------------------------+---------------------------------------------------+
|      | ...                                                   | It is odd that pointer to 'char' type is compared |
|      | if (m_szPassword != '\0')                             |  with the '\0' value.                             |
|   1  | {                                                     |  Probably meant: *m_szPassword != '\0'.           |
|      | ...                                                   |                                                   |
+------+-------------------------------------------------------+---------------------------------------------------+
|   2  | while ((*str==' ' || *str=='\t') && str!='\0') str++; | 同上                                              |
+------+-------------------------------------------------------+---------------------------------------------------+
测试用例
规则说明：
+---------------+--------------------------------------------------+
|    rule id    |                       V529                       |
+---------------+--------------------------------------------------+
|   rule name   |         AddSemiAfterIfForWhileCondition          |
+---------------+--------------------------------------------------+
| rule category |                    OddBehavior                   |
+---------------+--------------------------------------------------+
|   rule check  |             在'if/for/while'后添加';'            |
+---------------+--------------------------------------------------+
|    message    | Odd semicolon ';' after 'if/for/while' operator. |
+---------------+--------------------------------------------------+

代码示例总结：
+----------------------------------------------------------------------------------------------------+
|                                              V529示例                                              |
+----------------------------------------------------------------------------------------------------+
| 序号 |                       示例                       | 说明                                     |
+------+--------------------------------------------------+------------------------------------------+
|      | if(queue.GetSize() >= this->_limit);             | Odd semicolon ';' after 'if' operator.   |
|   1  | {                                                |                                          |
|      | }                                                |                                          |
+------+--------------------------------------------------+------------------------------------------+
|      | while(TheQueueBuffer::GetInstance()->Pop(pMsg)); | Odd semicolon ';' after 'while' operator |
|   2  | {                                                |                                          |
|      | }                                                |                                          |
+------+--------------------------------------------------+------------------------------------------+
测试用例
规则说明：
+---------------+-------------------------------------+
|    rule id    |                 V530                |
+---------------+-------------------------------------+
|   rule name   |   WithoutUseReturnValueOfFunction   |
+---------------+-------------------------------------+
| rule category |             OddBehavior             |
+---------------+-------------------------------------+
|   rule check  |         函数返回值应该被使用        |
+---------------+-------------------------------------+
|    message    | The return value of function 'Foo'  |
|               |     is required to be utilized.     |
+---------------+-------------------------------------+

代码示例总结：
+------------------------------------------------------------+
|                          V530示例                          |
+------------------------------------------------------------+
| 序号 |          示例         | 说明                        |
+------+-----------------------+-----------------------------+
|      | ...                   | 应该为ignoredprops.clear(); |
|   1  | ignoredprops.empty(); |                             |
|      | ...                   |                             |
+------+-----------------------+-----------------------------+
|      | if (m_from.size())    | 同上                        |
|   2  | m_from.empty();       |                             |
+------+-----------------------+-----------------------------+
测试用例
规则说明：
+---------------+-------------------------------------+
|    rule id    |                 V531                |
+---------------+-------------------------------------+
|   rule name   |         TwoSizeofMultiplied         |
+---------------+-------------------------------------+
| rule category |             OddBehavior             |
+---------------+-------------------------------------+
|   rule check  |            两个sizeof相乘           |
+---------------+-------------------------------------+
|    message    | It is odd that a sizeof() operator  |
|               |      is multiplied by sizeof().     |
+---------------+-------------------------------------+

代码示例总结：
+--------------------------------------------------------------------------------+
|                                    V531示例                                    |
+--------------------------------------------------------------------------------+
| 序号 |                            示例                            |    说明    |
+------+------------------------------------------------------------+------------+
|      | DWORD dwLen = ::LoadString(hInstDll, dwID,                 | 相乘很奇怪 |
|   1  | szTemp, (sizeof(szTemp) * sizeof(TCHAR)));                 |            |
+------+------------------------------------------------------------+------------+
|      | ...                                                        |    同上    |
|   2  | ListView_GetItemText(hwndListView, iIndex, 0, szEventType, |            |
|      | sizeof(szEventType) * sizeof(WCHAR));                      |            |
+------+------------------------------------------------------------+------------+
|   3  | DWORD dwBuffSize = sizeof(szBuffer)*sizeof(TCHAR);         |    同上    |
+------+------------------------------------------------------------+------------+
测试用例
规则说明：
+---------------+------------------------------------+
|    rule id    |                V532                |
+---------------+------------------------------------+
|   rule name   |    PointerUnaryAndDerefConfuse     |
+---------------+------------------------------------+
| rule category |           UnclearBehavior          |
+---------------+------------------------------------+
|   rule check  |        *pointer++意图不明确        |
+---------------+------------------------------------+
|               | Consider inspecting the statement  |
|    message    |      of '*pointer++' pattern.      |
|               |   Probably meant: '(*pointer)++'.  |
+---------------+------------------------------------+

代码示例总结：
+---------------------------------------------------------------------------+
|                                  V532示例                                 |
+---------------------------------------------------------------------------+
| 序号 |            示例           |                  说明                  |
+------+---------------------------+----------------------------------------+
|      | ...                       |  Consider inspecting the statement of  |
|   1  | if (pceltFetched != NULL) |  '*pointer++' pattern. Probably meant: |
|      | *pceltFetched++;          |             '(*pointer)++'.            |
|      | ...                       |                                        |
+------+---------------------------+----------------------------------------+
|   2  | *nLeftBord--;             |                  同上                  |
+------+---------------------------+----------------------------------------+
|   3  | *res  ++;                 |     '*res'和'++'有空格,应为(*res)++    |
+------+---------------------------+----------------------------------------+
测试用例
规则说明：
+---------------+----------------------------------------------------------+
|    rule id    |                           V533                           |
+---------------+----------------------------------------------------------+
|   rule name   |              WrongVariableIncreaseInForLoop              |
+---------------+----------------------------------------------------------+
| rule category |                       WrongBehavior                      |
+---------------+----------------------------------------------------------+
|   rule check  |                  for循环中，变量自增错误                 |
+---------------+----------------------------------------------------------+
|    message    | It is likely that a wrong variable is being incremented  |
|               |    inside the 'for' operator. Consider reviewing 'X'.    |
+---------------+----------------------------------------------------------+

代码示例总结：
+------------------------------------------------------------------------------------------------------+
|                                               V533示例                                               |
+------------------------------------------------------------------------------------------------------+
| 序号 |                          示例                          |                 说明                 |
+------+--------------------------------------------------------+--------------------------------------+
|      | for ( j = 0; j < w.GetNumPoints(); j++ ) {             |               应该写成               |
|   1  | for ( k = 0; k < verts.Num(); j++ ) {                  | for ( k = 0; k < verts.Num(); k++ ). |
+------+--------------------------------------------------------+--------------------------------------+
|      | for( uint32 NextLineIdx = LineIdx + 1;// <=            |                                      |
|   2  | NextLineIdx < NumFileLines &&                          |           应为NextLineIdx++          |
|      | LinesToProcess[NextLineIdx].Trim().TrimTrailing()....; |                                      |
|      | ++LineIdx )                                            |                                      |
+------+--------------------------------------------------------+--------------------------------------+
|   3  | for(i=0;i<A.dim();i++)                                 |                  同1                 |
|      | for(int j=0;j<A.dim();i++)                             |                                      |
+------+--------------------------------------------------------+--------------------------------------+

测试用例
规则说明：
+---------------+-------------------------------------------------------+
|    rule id    |                          V534                         |
+---------------+-------------------------------------------------------+
|   rule name   |             WrongVariableComparedInForLoop            |
+---------------+-------------------------------------------------------+
| rule category |                     WrongBehavior                     |
+---------------+-------------------------------------------------------+
|   rule check  |              for循环中，使用错误变量比较              |
+---------------+-------------------------------------------------------+
|    message    | It is likely that a wrong variable is being compared  |
|               |   inside the 'for' operator. Consider reviewing 'X'.  |
+---------------+-------------------------------------------------------+
代码示例总结：
+------------------------------------------------------------------------------------------------+
|                                            V534示例                                            |
+------------------------------------------------------------------------------------------------+
| 序号 |                       示例                      |                  说明                 |
+------+-------------------------------------------------+---------------------------------------+
|      | for ( i = 0; i < segments; i++ )                |                                       |
|      | {                                               |                                       |
|      | ....                                            |                                       |
|      | for ( int j = 0; i < iBranches; j++ )           |                应该写成               |
|   1  | {                                               | for ( int j = 0; j < iBranches; j++ ) |
|      | curSeg.m_flWidth *= 0.5;                        |                                       |
|      | }                                               |                                       |
|      | ....                                            |                                       |
|      | }                                               |                                       |
+------+-------------------------------------------------+---------------------------------------+
|      | ....                                            |                                       |
|      | for (UINT i = 0; i < pResource->SurfCount; ++i) |                                       |
|      | {                                               |                                       |
|      | ....                                            |                                       |
|      | if (SUCCEEDED(hr))                              |                                       |
|   2  | {....}                                          |                                       |
|      | else{                                           |                                       |
|      | for (UINT j = 0; i < j; ++j)                    |                应为j<i                |
|      | {....}                                          |                                       |
|      | break;                                          |                                       |
|      | }                                               |                                       |
|      | }                                               |                                       |
+------+-------------------------------------------------+---------------------------------------+

测试用例
规则说明：
+---------------+----------------------------------------------+
|    rule id    |                     V535                     |
+---------------+----------------------------------------------+
|   rule name   |          SameVariableUseInForLoop            |
+---------------+----------------------------------------------+
| rule category |                 WrongBehavior                |
+---------------+----------------------------------------------+
|   rule check  |                两层for循环中，               |
|               |               使用相同变量循环               |
+---------------+----------------------------------------------+
|    message    | The variable 'X' is being used for this loop |
|               |            and for the outer loop.           |
+---------------+----------------------------------------------+
代码示例总结：
+-------------------------------------------------------------------------------+
|                                    V535示例                                   |
+-------------------------------------------------------------------------------+
| 序号 |                    示例                   |            说明            |
+------+-------------------------------------------+----------------------------+
|      | size_t i, j;                              |                            |
|      | for(i = 0; i < mGeometryList.size(); i++) |                            |
|      | {                                         |                            |
|      | ...                                       | 两层都用的'i', 内层应为'j' |
|   1  | for (i = 0; i < mVertices.size(); ++i)    |                            |
|      | {                                         |                            |
|      | CommonVertex& c = mVertices[i];           |                            |
|      | ...                                       |                            |
|      | }                                         |                            |
|      | }                                         |                            |
+------+-------------------------------------------+----------------------------+
|      | for(j=0; j < numrepeats; j++){            |                            |
|      | ...                                       |                            |
|      | for(i=0; i < num_joints; i++){            |                            |
|      | ...                                       |                            |
|      | for(j=0;j < num_joints;j++){              |                            |
|   2  | if(joints[j].locked)freely=0;             |                            |
|      | }                                         |       第一层和第三层       |
|      | ...                                       |      使用相同变量循环      |
|      | }                                         |                            |
|      | ...                                       |                            |
|      | }                                         |                            |
+------+-------------------------------------------+----------------------------+

测试用例
规则说明：
+---------------+----------------------------------------------+
|    rule id    |                     V536                     |
+---------------+----------------------------------------------+
|   rule name   |          ConstantValueWithZeroPrefix         |
+---------------+----------------------------------------------+
| rule category |                UnclearBehavior               |
+---------------+----------------------------------------------+
|   rule check  |                常数前带0表示，               |
|               |               建议使用8进制表示              |
+---------------+----------------------------------------------+
|    message    | Be advised that the utilized constant value  |
|               |       is represented by an octal form.       |
+---------------+----------------------------------------------+

代码示例总结：
+----------------------------------------------------------------------------+
|                                  V536示例                                  |
+----------------------------------------------------------------------------+
| 序号 |                        示例                       |       说明      |
+------+---------------------------------------------------+-----------------+
|      | oCell._luminance = 2220*iPixel._red +             |  0713为8进制，  |
|   1  | 7067*iPixel._blue +                               |     非10进制    |
|      | 0713*iPixel._green; // <=                         |                 |
+------+---------------------------------------------------+-----------------+
|   2  | CLUIFramesCreateMenuForFrame(-1,-1,000010000,     |                 |
|      | MS_CLIST_ADDCONTEXTFRAMEMENUITEM);                | 000010000八进制 |
+------+---------------------------------------------------+-----------------+
|      | static CodeMap map[]=                             |                 |
|      | {                                                 |                 |
|      | {037, _T("IBM037")},// IBM EBCDIC US-Canada,// <= |                 |
|      | {437, _T("IBM437")},// OEM United States          | 037为8进制      |
| 3    | {500, _T("IBM500")},// IBM EBCDIC International   |                 |
|      | ....                                              |                 |
|      | };                                                |                 |
+------+---------------------------------------------------+-----------------+

测试用例
规则说明：
+---------------+---------------------------------------------------------+
|    rule id    |                           V537                          |
+---------------+---------------------------------------------------------+
|   rule name   |             InConsistentPatternInExpression             |
+---------------+---------------------------------------------------------+
| rule category |                   InConsistentBehavior                  |
+---------------+---------------------------------------------------------+
|   rule check  |                 表达式模式前后不保持一致                |
+---------------+---------------------------------------------------------+
|    message    | Consider reviewing the correctness of 'X' item's usage. |
+---------------+---------------------------------------------------------+

代码示例总结：
+---------------------------------------------------------------------------------------------+
|                                           V537示例                                          |
+---------------------------------------------------------------------------------------------+
| 序号 |                            示例                           |           说明           |
+------+-----------------------------------------------------------+--------------------------+
|      | VOL.obmc_disable = par->obmc_disable;                     |                          |
|   1  | VOL.sprite_enable = par->sprite_enable;                   |                          |
|      | VOL.sprite_width = par->sprite_width;                     | 'sprite_left_coordinate' |
|      | VOL.sprite_height = par->sprite_height;                   |        未保持一致        |
|      | VOL.sprite_left_coordinate = par->sprite_left_coordinate; |                          |
|      | VOL.sprite_top_coordinate = par->sprite_left_coordinate;  |                          |
+------+-----------------------------------------------------------+--------------------------+
|   2  | minX=max(0,minX+mcLeftStart-2);                           |                          |
|      | minY=max(0,minY+mcTopStart-2);                            |        maxY不一致        |
|      | maxX=min((int)width,maxX+mcRightEnd-1);                   |                          |
|      | maxY=min((int)height,maxX+mcBottomEnd-1);                 |                          |
+------+-----------------------------------------------------------+--------------------------+
| 3    | x = ( v[ 0 ] - p->origin[ 0 ] ) / p->scale_x;             |        y未保持一致       |
|      | y = ( v[ 1 ] - p->origin[ 1 ] ) / p->scale_x;             |                          |
+------+-----------------------------------------------------------+--------------------------+
|      | const XML_Char *att1 = *(const XML_Char **)p1;            |                          |
|      | const XML_Char *att2 = *(const XML_Char **)p2;            |         sep1和sp2        |
| 4    | int sep1 = (tcsrchr(att1, NSSEP) != 0);                   |                          |
|      | int sep2 = (tcsrchr(att1, NSSEP) != 0);                   |                          |
+------+-----------------------------------------------------------+--------------------------+

测试用例
规则说明：
+---------------+------------------------------------------------+
|    rule id    |                      V539                      |
+---------------+------------------------------------------------+
|   rule name   |               IteratorsAsArgument              |
+---------------+------------------------------------------------+
| rule category |             UnderlyingErrorBehavior            |
+---------------+------------------------------------------------+
|   rule check  |               迭代器作为函数参数               |
+---------------+------------------------------------------------+
|    message    | Consider inspecting iterators which are being  |
|               |     passed as arguments to function 'Foo'.     |
+---------------+------------------------------------------------+

代码示例总结：
+---------------------------------------------------------------------+
|                               V539示例                              |
+---------------------------------------------------------------------+
| 序号 |                   示例                   |        说明       |
+------+------------------------------------------+-------------------+
|      | ....                                     |                   |
|      | std::vector& rPeaks = m_peaks;           |                   |
|      | // Go through all peaks.                 | m_peaks迭代器作为 |
|      | for (int i = 0; i<rPeaks.size(); i++)    |   rPeaks参数输入  |
|      | {                                        |                   |
|      | if(age>fHotToColdTime){                  |                   |
|   1  | rPeaks.erase(m_peaks.begin() + i); // <= |                   |
|      | i--;                                     |                   |
|      | }                                        |                   |
|      | ....                                     |                   |
|      | }                                        |                   |
+------+------------------------------------------+-------------------+

测试用例
规则说明：
+---------------+-----------------------------------+
|    rule id    |                V540               |
+---------------+-----------------------------------+
|   rule name   |   InvalidInitWithWideCharPointer  |
+---------------+-----------------------------------+
| rule category |      UnderlyingErrorBehavior      |
+---------------+-----------------------------------+
|   rule check  |          宽字符串初始化时         |
|               |           两个'\0\0'结尾          |
+---------------+-----------------------------------+
|    message    | Member 'x' should point to string |
|               |   terminated by two 0 characters. |
+---------------+-----------------------------------+

代码示例总结：
+------------------------------------------------------------------------------+
|                                   V540示例                                   |
+------------------------------------------------------------------------------+
| 序号 |             示例             |                  说明                  |
+------+------------------------------+----------------------------------------+
|      | info.lpstrFilter = L"*.txt"; |  Member 'lpstrFilter' should point to  |
|   1  |                              | string terminated by two 0 characters. |
+------+------------------------------+----------------------------------------+
| 2    | Data.pTo = L"";              | Member 'pTo' should point to string    |
|      |                              |  terminated by two 0 characters.       |
+------+------------------------------+----------------------------------------+

测试用例
规则说明：
+---------------+--------------------------------------------------+
|    rule id    |                       V541                       |
+---------------+--------------------------------------------------+
|   rule name   |        FormatStringIntoItselfInSprintf           |
+---------------+--------------------------------------------------+
| rule category |              UnderlyingErrorBehavior             |
+---------------+--------------------------------------------------+
|   rule check  |              格式化时输出到自己身上              |
+---------------+--------------------------------------------------+
|    message    | It is dangerous to print the string into itself. |
+---------------+--------------------------------------------------+

代码示例总结：
+---------------------------------------------------------------------------+
|                                  V541示例                                 |
+---------------------------------------------------------------------------+
| 序号 |                示例                |              说明             |
+------+------------------------------------+-------------------------------+
|      | sprintf(newhost, "%s:%d", newhost, |     The code might work,      |
|   1  | PR_ntohs(inet_addr.inet.port));    | but this is a dangerous game. |
+------+------------------------------------+-------------------------------+
|   2  | sprintf(tmpStr,"%s (%s)",          |              同上             |
|      | tmpStr,FindData.cFileName);        |                               |
+------+------------------------------------+-------------------------------+

测试用例
规则说明：
+---------------+------------------------------------------------------------+
|    rule id    |                            V542                            |
+---------------+------------------------------------------------------------+
|   rule name   |                         OddTypeCast                        |
+---------------+------------------------------------------------------------+
| rule category |                       UnclearBehavior                      |
+---------------+------------------------------------------------------------+
|   rule check  |                       奇怪的类型转换                       |
+---------------+------------------------------------------------------------+
|    message    | Consider inspecting an odd type cast: 'Type1' to ' Type2'. |
+---------------+------------------------------------------------------------+

代码示例总结：
+---------------------------------------------------------------------------------------------------------+
|                                                 V542示例                                                |
+---------------------------------------------------------------------------------------------------------+
| 序号 |                           示例                           |                  说明                 |
+------+----------------------------------------------------------+---------------------------------------+
|      | static void                                              | Consider inspecting an odd type cast: |
|   1  | sttRegisterToolBarButton(..., char * pszButtonName, ...) |           'char *' to 'char'.         |
|      | {                                                        |        This code is suspicious.       |
|      | ...                                                      |                                       |
|      | if((BYTE)pszButtonName)                                  |                                       |
|      | tbb.tbbFlags=TBBF_FLEXSIZESEPARATOR;                     |                                       |
|      | else                                                     |                                       |
|      | tbb.tbbFlags=TBBF_ISSEPARATOR;                           |                                       |
|      | ...                                                      |                                       |
|      | }                                                        |                                       |
+------+----------------------------------------------------------+---------------------------------------+

测试用例
规则说明：
+---------------+---------------------------------------+
|    rule id    |                  V543                 |
+---------------+---------------------------------------+
|   rule name   |        Odd_HRESULT_ValueAssign        |
+---------------+---------------------------------------+
| rule category |        UnderlyingErrorBehavior        |
+---------------+---------------------------------------+
|   rule check  |               奇怪的赋值              |
+---------------+---------------------------------------+
|    message    | It is odd that value 'X' is assigned  |
|               |  to the variable 'Y' of HRESULT type. |
+---------------+---------------------------------------+

代码示例总结：
+-------------------------------------------------------------------------------------+
|                                       V543示例                                      |
+-------------------------------------------------------------------------------------+
| 序号 |            示例           |                       说明                       |
+------+---------------------------+--------------------------------------------------+
|      | HRESULT h;                |     It is odd that value '-1' is assigned to     |
|   1  | ...                       |          the variable 'h' of HRESULT type        |
|      | // set h to FAILED        |                                                  |
|      | h = -1;                   |                                                  |
|      | ...                       |                                                  |
+------+---------------------------+--------------------------------------------------+
| 2    | mRemoveSavedState = true; | It is odd that value 'true' is assigned to       |
|      |                           | the variable 'mRemoveSavedState' of HRESULT type |
+------+---------------------------+--------------------------------------------------+

测试用例
规则说明：
+---------------+------------------------------------------------------------+
|    rule id    |                            V545                            |
+---------------+------------------------------------------------------------+
|   rule name   |                   HRESULT_ValueCondition                   |
+---------------+------------------------------------------------------------+
| rule category |                   UnderlyingErrorBehavior                  |
+---------------+------------------------------------------------------------+
|   rule check  |                  HRESULT表达式比较，应用宏                 |
+---------------+------------------------------------------------------------+
|    message    | Such conditional expression of 'if' statement is incorrect |
|               |              for the HRESULT type value 'Foo'.             |
|               |    The SUCCEEDED or FAILED macro should be used instead.   |
+---------------+------------------------------------------------------------+

代码示例总结：
+-----------------------------------------------------------------------------------------------------------+
|                                                  V545示例                                                 |
+-----------------------------------------------------------------------------------------------------------+
| 序号 |                              示例                              |                说明               |
+------+----------------------------------------------------------------+-----------------------------------+
|      | if (AVIStreamInfo(pas, &asi, sizeof asi))                      | 返回类型为'HRESULT'时作条件语句， |
|   1  | return 0;                                                      |     应使用SUCCEEDED或FAILED宏     |
+------+----------------------------------------------------------------+-----------------------------------+
| 2    | HRESULT nRC = ScriptItemize(....);                             |                同上               |
|      | if( !nRC ) // break loop when everything is correctly itemized |                                   |
|      | break;                                                         |                                   |
+------+----------------------------------------------------------------+-----------------------------------+

测试用例
规则说明：
+---------------+----------------------------------+
|    rule id    |               V547               |
+---------------+----------------------------------+
|   rule name   |  ConstResultAccordToValueRange   |
+---------------+----------------------------------+
| rule category |           KnownBehavior          |
+---------------+----------------------------------+
|   rule check  |       按照变量的表示范围，       |
|               |          表达式总为真/假         |
+---------------+----------------------------------+
|    message    | Expression is always true/false. |
+---------------+----------------------------------+

代码示例总结：
+----------------------------------------------------------------------------------------------------------+
|                                                 V547示例                                                 |
+----------------------------------------------------------------------------------------------------------+
| 序号 |                     示例                    |                         说明                        |
+------+---------------------------------------------+-----------------------------------------------------+
|      | if ( nBytes > 3 &&                          | Expression 'pBytes [ 0 ] == 0xEF' is always false.  |
|   1  | pBytes[0] == 0xEF &&                        |   The value range of signed char type: [-128, 127]  |
|      | pBytes[1] == 0xBB &&                        |                                                     |
|      | pBytes[2] == 0xBF )                         |                                                     |
+------+---------------------------------------------+-----------------------------------------------------+
|   2  | if (UTF16BeToLeChar(pBytes, nNumBytes) < 0) |             Expression is always false.             |
|      |                                             |          Unsigned type value is never < 0.          |
+------+---------------------------------------------+-----------------------------------------------------+
|   3  | else if (*s > 127) *s = '~';                | Expression '* s > 127' is always false.             |
|      |                                             | The value range of signed char type: [-128, 127]    |
+------+---------------------------------------------+-----------------------------------------------------+
| 4    | while((len - indx) >= 0 && indx <= 2) {     | Expression '( len - indx ) >= 0' is always true.    |
|      |                                             | Unsigned type value is always >= 0                  |
+------+---------------------------------------------+-----------------------------------------------------+

测试用例
规则说明：
+---------------+-------------------------------------------+
|    rule id    |                    V548                   |
+---------------+-------------------------------------------+
|   rule name   |           TwoDimArrayToPointer            |
+---------------+-------------------------------------------+
| rule category |          UnderlyingErrorBehavior          |
+---------------+-------------------------------------------+
|   rule check  |          二维数组转化为指针的指针         |
+---------------+-------------------------------------------+
|    message    |     Consider reviewing type casting.      |
|               | TYPE X[][] in not equivalent to TYPE **X. |
+---------------+-------------------------------------------+

代码示例总结：
+-----------------------------------------------------------------------------------+
|                                      V548示例                                     |
+-----------------------------------------------------------------------------------+
| 序号 |                            示例                           |      说明      |
+------+-----------------------------------------------------------+----------------+
|      | double cameraXYZ[4][3];                                   | 二维数组转化为 |
|   1  | for (uint32 j = 0; j < 12; j++) {                         |   指针的指针   |
|      | ((double**)cameraXYZ)[0][j] = table[i].trans[j] /10000.0; |                |
|      | }                                                         |                |
+------+-----------------------------------------------------------+----------------+

测试用例
规则说明：
+---------------+-----------------------------------------+
|    rule id    |                   V549                  |
+---------------+-----------------------------------------+
|   rule name   |         SameArgumentForFuncCall         |
+---------------+-----------------------------------------+
| rule category |                CopyError                |
+---------------+-----------------------------------------+
|   rule check  |           调用函数两个变量相同          |
+---------------+-----------------------------------------+
|    message    | The 'first' argument of 'Foo' function  |
|               |    is equal to the 'second' argument.   |
+---------------+-----------------------------------------+

代码示例总结：
+------------------------------------------------------------------------------------------------+
|                                            V549示例                                            |
+------------------------------------------------------------------------------------------------+
| 序号 |                              示例                              |          说明          |
+------+----------------------------------------------------------------+------------------------+
|      | _swab((char*)&*m_aaActualBitmapBits[i].begin(),                | 第一个和第二个参数相同 |
|   1  | (char*)&*m_aaActualBitmapBits[i].begin()                       |                        |
|      | ,NumberOfPixels/8);                                            |                        |
+------+----------------------------------------------------------------+------------------------+
|   2  | if ((c & locale::all) == 0 ||                                  |     strcmp参数相同     |
|      | strcmp(name1, name1) == 0)                                     |                        |
+------+----------------------------------------------------------------+------------------------+
|   3  | EXPECT_EQ(0, memcmp(buffer2->data(), buffer2->data(), 10000)); |     memcmp参数相同     |
+------+----------------------------------------------------------------+------------------------+

测试用例
规则说明：
+---------------+-----------------------------------------------------+
|    rule id    |                         V550                        |
+---------------+-----------------------------------------------------+
|   rule name   |            OddFloatPreciseComparision               |
+---------------+-----------------------------------------------------+
| rule category |                   UnderlyingError                   |
+---------------+-----------------------------------------------------+
|   rule check  |               比较浮点数时最好使用fabs              |
+---------------+-----------------------------------------------------+
|    message    | An odd precise comparison. It's probably better to  |
|               |       use a comparison with defined precision:      |
|               |    fabs(A - B) < Epsilon or fabs(A - B) > Epsilon   |
+---------------+-----------------------------------------------------+

代码示例总结：
+-----------------------------------------------------------------------------------------+
|                                         V550示例                                        |
+-----------------------------------------------------------------------------------------+
| 序号 |                        示例                        |             说明            |
+------+----------------------------------------------------+-----------------------------+
|   1  | lon = (y == 0 && x == 0) ? 0.0 : rtd(atan2(y, x)); | An odd precise comparison:  |
|      |                                                    |           x == 0.           |
+------+----------------------------------------------------+-----------------------------+
|   2  | if (x == 0) y = 1.0;                               |             同上            |
+------+----------------------------------------------------+-----------------------------+

测试用例
规则说明：
+---------------+----------------------------------------------------------+
|    rule id    |                           V552                           |
+---------------+----------------------------------------------------------+
|   rule name   |                                                   |
+---------------+----------------------------------------------------------+
| rule category |                      UnderlyingError                     |
+---------------+----------------------------------------------------------+
|   rule check  |                     bool类型递增运算                     |
+---------------+----------------------------------------------------------+
|    message    |        A bool type variable is being incremented.        |
|               |  Perhaps another variable should be incremented instead. |
+---------------+----------------------------------------------------------+

代码示例总结：
+----------------------------------------------------------------------------------------------------------+
|                                                 V552示例                                                 |
+----------------------------------------------------------------------------------------------------------+
| 序号 |                         示例                         |                    说明                    |
+------+------------------------------------------------------+--------------------------------------------+
|      | ....                                                 |                                            |
|      | bool numMethods = 0;                                 |                                            |
|      | for (unsigned i = 0; i < ARRAY_SIZE(k_Methods); i++) |                                            |
|      | {                                                    | A bool type variable is being incremented: |
|      | if (methodMask & ((UInt32)1 << i))                   |               numMethods ++.               |
|   1  | {                                                    |     Perhaps another variable should be     |
|      | res.Add_Space_if_NotEmpty();                         |             incremented instead            |
|      | res += k_Methods[i];                                 |                                            |
|      | numMethods++;// <=                                   |                                            |
|      | }                                                    |                                            |
|      | }                                                    |                                            |
+------+------------------------------------------------------+--------------------------------------------+

测试用例
规则说明：
+---------------+---------------------------------+
|    rule id    |               V554              |
+---------------+---------------------------------+
|   rule name   |    IncorrectUseOfSmartPointer   |
+---------------+---------------------------------+
| rule category |         UnderlyingError         |
+---------------+---------------------------------+
|   rule check  |        smart指针使用错误        |
+---------------+---------------------------------+
|    message    | Incorrect use of smart pointer. |
+---------------+---------------------------------+

代码示例总结：
+----------------------------------------------------------------------------------------------+
|                                           V554示例                                           |
+----------------------------------------------------------------------------------------------+
| 序号 |                       示例                      |                 说明                |
+------+-------------------------------------------------+-------------------------------------+
|      |                                                 |     Incorrect use of auto_ptr.      |
|   1  | auto_ptr child_array(new VARIANT[child_count]); | The memory allocated with 'new []'  |
|      |                                                 |   will be cleaned using 'delete'.   |
+------+-------------------------------------------------+-------------------------------------+

测试用例
规则说明：
+---------------+----------------------------------------+
|    rule id    |                  V555                  |
+---------------+----------------------------------------+
|   rule name   |       UnsignedValueMinusComapre        |
+---------------+----------------------------------------+
| rule category |             UnderlyingError            |
+---------------+----------------------------------------+
|   rule check  |      A和B都为unsigned int时,A-B>=0     |
+---------------+----------------------------------------+
|    message    | The expression of the 'A - B > 0' kind |
|               |          will work as 'A != B'.        |
+---------------+----------------------------------------+

代码示例总结：
+---------------------------------------------------------------------------------------------------+
|                                              V555示例                                             |
+---------------------------------------------------------------------------------------------------+
| 序号 |                 示例                 |                         说明                        |
+------+--------------------------------------+-----------------------------------------------------+
|   1  | if ( have_cluster > 0 &&             | The expression 'ppw_ref.size() - have_cluster > 0'  |
|      |  ppw_ref.size() - have_cluster > 0 ) |    will work as 'ppw_ref.size() != have_cluster'.   |
+------+--------------------------------------+-----------------------------------------------------+
| 2    | if (wcslen(dir) - wcslen(DirTmp)>0)  |                         同上                        |
+------+--------------------------------------+-----------------------------------------------------+

测试用例
规则说明：
+---------------+--------------------------------------------------+
|    rule id    |                       V556                       |
+---------------+--------------------------------------------------+
|   rule name   |               DifferentEnumComparison            |
+---------------+--------------------------------------------------+
| rule category |                  UnderlyingError                 |
+---------------+--------------------------------------------------+
|   rule check  |               不同的枚举变量值比较               |
+---------------+--------------------------------------------------+
|    message    | The values of different enum types are compared. |
+---------------+--------------------------------------------------+

代码示例总结：
+------------------------------------------------------------------------------------------------------------------------------+
|                                                           V556示例                                                           |
+------------------------------------------------------------------------------------------------------------------------------+
| 序号 |                                       示例                                      |                 说明                |
+------+---------------------------------------------------------------------------------+-------------------------------------+
|      | enum EHAlign { Left, Middle , Right,};                                          |  The values of different enum types |
|      | enum EVAlign { Top,,Center , Bottom };                                          |   are compared: enuHAlign == Center |
|      | void CxStatic::SetHAlign(EHAlign enuHAlign)                                     |                                     |
|   1  | {                                                                               |                                     |
|      | ...                                                                             |                                     |
|      | if (enuHAlign == Center)                                                        |                                     |
|      | ...                                                                             |                                     |
|      | }                                                                               |                                     |
+------+---------------------------------------------------------------------------------+-------------------------------------+
| 2    | PCHAR                                                                           |  The values of different enum types |
|      | DbgDevicePowerString(IN WDF_POWER_DEVICE_STATE Type)                            |  are compared: switch(ENUM_TYPE_A)  |
|      | {                                                                               |      { case ENUM_TYPE_B: ... }      |
|      | ....                                                                            |                                     |
|      | case WdfPowerDeviceD0:                                                          |                                     |
|      | return "WdfPowerDeviceD0";                                                      |                                     |
|      | case PowerDeviceD1:                                                             |                                     |
|      | return "WdfPowerDeviceD1";                                                      |                                     |
|      | case WdfPowerDeviceD2:                                                          |                                     |
|      | return "WdfPowerDeviceD2";                                                      |                                     |
|      | ....                                                                            |                                     |
|      | }                                                                               |                                     |
+------+---------------------------------------------------------------------------------+-------------------------------------+
| 3    | if ( player.Hand.insurance > 0 &&,Players[0].Hand.state == HR_PlayerBlackJack ) |                                     |
+------+---------------------------------------------------------------------------------+-------------------------------------+

测试用例
规则说明：
+---------------+----------------------------+
|    rule id    |            V557            |
+---------------+----------------------------+
|   rule name   |    ArrayIndexOutOfBound    |
+---------------+----------------------------+
| rule category |          Overflow          |
+---------------+----------------------------+
|   rule check  |        数组下标越界        |
+---------------+----------------------------+
|    message    | Array overrun is possible. |
+---------------+----------------------------+

代码示例总结：
+----------------------------------------------------------------------------------------------------------+
|                                                 V557示例                                                 |
+----------------------------------------------------------------------------------------------------------+
| 序号 |                        示例                       |                      说明                     |
+------+---------------------------------------------------+-----------------------------------------------+
|      |                                                   |           Array overrun is possible.          |
|      | struct ConvoluteFilterData {                      |  The '9' index is pointing beyond array bound |
|      | long m[9];                                        |                                               |
|   1  | ...                                               |                                               |
|      | };                                                |                                               |
|      | long rt0=cfd->m[9], gt0=cfd->m[9], bt0=cfd->m[9]; |                                               |
+------+---------------------------------------------------+-----------------------------------------------+
|   2  | sample->filename[ 14 ] = 0;                       |                      同上                     |
+------+---------------------------------------------------+-----------------------------------------------+
|      | static char findWhat[FINDBUFFLEN] = {'\0'};       |                      同上                     |
|   3  | ...                                               |                                               |
|      | findWhat[FINDBUFFLEN] = '\0';                     |                                               |
+------+---------------------------------------------------+-----------------------------------------------+
测试用例
规则说明：
+---------------+--------------------------------------------+
|    rule id    |                    V558                    |
+---------------+--------------------------------------------+
|   rule name   |         ReturnPointerToLocalVariable       |
+---------------+--------------------------------------------+
| rule category |               InvalidPointer               |
+---------------+--------------------------------------------+
|   rule check  |              返回局部变量指针              |
+---------------+--------------------------------------------+
|    message    | Function returns the pointer/reference to  |
|               |           temporary local object.          |
+---------------+--------------------------------------------+

代码示例总结：
+-------------------------------------------------------------+
|                           V558示例                          |
+-------------------------------------------------------------+
| 序号 |                  示例                 |     说明     |
+------+---------------------------------------+--------------+
|      | SingleLinkedListIterator res = *this; |              |
|   1  | ++*this;                              | 指针引用返回 |
|      | return res;                           |              |
+------+---------------------------------------+--------------+
测试用例
V559
规则说明：
+---------------+------------------------------------------------------+
|    rule id    |                         V559                         |
+---------------+------------------------------------------------------+
|   rule name   |                   AssignInCondition                  |
+---------------+------------------------------------------------------+
| rule category |                    UnderlyingError                   |
+---------------+------------------------------------------------------+
|   rule check  |                 在条件语句中出现赋值                 |
+---------------+------------------------------------------------------+
|    message    |           Suspicious assignment inside the           |
|               |  conditional expression of 'if/while/for' statement. |
+---------------+------------------------------------------------------+

代码示例总结：
+-------------------------------------------------------------+
|                           V559示例                          |
+-------------------------------------------------------------+
| 序号 |                   示例                  |    说明    |
+------+-----------------------------------------+------------+
|      | if (ret=0) {return (0);}                | 应为ret==0 |
|   1  |                                         |            |
+------+-----------------------------------------+------------+
|   2  | else if (ft->ft_magic = FT_MAGIC_OSCAR) | 同上       |
+------+-----------------------------------------+------------+
测试用例

V560
+---------------+--------------------------------------+
|    rule id    |                 V560                 |
+---------------+--------------------------------------+
|   rule name   | PartOfConditionIsConstantValue       |
+---------------+--------------------------------------+
| rule category |            ConstantResult            |
+---------------+--------------------------------------+
|   rule check  |     条件语句一部分总为true/false     |
+---------------+--------------------------------------+
|    message    |   A part of conditional expression   |
|               |         is always true/false.        |
+---------------+--------------------------------------+

代码示例总结：
+---------------------------------------------------------------------------------------------------------------------+
|                                                       V560示例                                                      |
+---------------------------------------------------------------------------------------------------------------------+
| 序号 |                                   示例                                   |                说明               |
+------+--------------------------------------------------------------------------+-----------------------------------+
|      | if(findDistancefast(,&coords,&victim->coords)<(scale*5)*(scale*5)*3&&3&& |  A part of conditional expression |
|   1  | animation[victim->targetanimation].height!=lowheight)                    |          is always true:3         |
+------+--------------------------------------------------------------------------+-----------------------------------+
|   2  | return c == 0x9 || 0xA || c == 0xD ||                                    | A part of conditional expression  |
|      | c >= 0x20 && c <= 0xD7FF ||                                              | is always true: 0xA               |
|      | c >= 0xE000 && c <= 0xFFFD ||                                            |                                   |
|      | c >= 0x10000 && c <= 0x10FFFF;                                           |                                   |
+------+--------------------------------------------------------------------------+-----------------------------------+


